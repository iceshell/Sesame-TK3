# èŠéº»ç²’-TK3 å…¨é¢ä¼˜åŒ–å®æ–½æ€»ç»“

**ä¼˜åŒ–æ—¥æœŸ**: 2025-10-19 00:32  
**å®ŒæˆçŠ¶æ€**: âœ… 9é¡¹ä¼˜åŒ–å…¨éƒ¨å®Œæˆ

---

## âœ… ä¼˜åŒ–é¡¹ç›®å®Œæˆæ¸…å•

| åºå· | ä¼˜åŒ–é¡¹ | çŠ¶æ€ | æ–‡ä»¶ |
|------|--------|------|------|
| 1 | 00:00å”¤é†’è½¯ä»¶ | âœ… | SmartScheduler.kt |
| 2 | ç‰ˆæœ¬æ˜¾ç¤ºé—®é¢˜ | âœ… | VersionLogger.kt (å·²æ­£ç¡®) |
| 3 | 1009é”™è¯¯é€€é¿ï¼ˆ10åˆ†é’Ÿï¼‰ | âœ… | RpcErrorHandler.kt (æ–°å¢) |
| 4 | åŠ¨æ€å¹¶å‘æ§åˆ¶ | âœ… | RpcErrorHandler.kt |
| 5 | å¥½å‹æ™ºèƒ½ç­›é€‰ | âœ… | ForestFriendManager.kt (æ–°å¢) |
| 6 | æ‰¾èƒ½é‡æˆåŠŸç‡ç»Ÿè®¡ | âœ… | ForestFriendManager.kt |
| 7 | ä»»åŠ¡æ‰§è¡Œé¡ºåºä¼˜åŒ– | âœ… | CoroutineTaskRunner.kt |
| 8 | config_v2.jsonåˆ†æ | âœ… | è§æŠ¥å‘Š |
| 9 | æ—¥å¿—æ¨¡å—åˆ†æ | âœ… | è§æŠ¥å‘Š |

---

## ğŸ“Š æ ¸å¿ƒä¼˜åŒ–å†…å®¹

### 1. RpcErrorHandler.kt (æ–°å¢)
**åŠŸèƒ½**:
- âœ… 1009é”™è¯¯è‡ªåŠ¨æš‚åœ10åˆ†é’Ÿ
- âœ… æ¥å£æˆåŠŸç‡å®æ—¶ç»Ÿè®¡
- âœ… åŠ¨æ€å¹¶å‘æ§åˆ¶ï¼ˆ20-60è‡ªé€‚åº”ï¼‰
- âœ… ç»Ÿè®¡æŠ¥å‘Šç”Ÿæˆ

### 2. ForestFriendManager.kt (æ–°å¢)
**åŠŸèƒ½**:
- âœ… å¥½å‹èƒ½é‡æ•°æ®ç»Ÿè®¡
- âœ… æ™ºèƒ½ç­›é€‰å‰100ä½å¥½å‹
- âœ… æ‰¾èƒ½é‡æˆåŠŸç‡ç»Ÿè®¡
- âœ… åŠ¨æ€è°ƒæ•´å†·å´æ—¶é—´ï¼ˆ10-20åˆ†é’Ÿï¼‰

### 3. SmartScheduler.kt (ä¿®æ”¹)
**æ–°å¢**:
- âœ… 00:00å”¤é†’æ—¶é—´ç‚¹
- âœ… 00:05æ‰§è¡Œæ—¶é—´ç‚¹

### 4. CoroutineTaskRunner.kt (ä¿®æ”¹)
**ä¼˜åŒ–**:
- âœ… æ£®æ—ä»»åŠ¡ä¼˜å…ˆçº§æœ€é«˜
- âœ… èƒ½é‡ç›¸å…³ä»»åŠ¡å…¶æ¬¡
- âœ… å…¶ä»–ä»»åŠ¡é å

---

## ğŸ”§ å…³é”®ä»£ç ç¤ºä¾‹

### ä½¿ç”¨1009é€€é¿æœºåˆ¶
```kotlin
// æ£€æŸ¥æ¥å£æ˜¯å¦è¢«æš‚åœ
if (RpcErrorHandler.isApiSuspended(apiMethod)) {
    return null
}

// å¤„ç†1009é”™è¯¯
if (errorCode == 1009) {
    RpcErrorHandler.handle1009Error(apiMethod)
}
```

### ä½¿ç”¨åŠ¨æ€å¹¶å‘
```kotlin
// è·å–å»ºè®®å¹¶å‘æ•°
val concurrency = RpcErrorHandler.getDynamicConcurrency()
// è¿”å›: 20-60ä¹‹é—´ï¼Œæ ¹æ®æˆåŠŸç‡å’Œæ—¶é—´æ®µåŠ¨æ€è°ƒæ•´
```

### ä½¿ç”¨æ™ºèƒ½å¥½å‹ç­›é€‰
```kotlin
// ä»587ä½å¥½å‹ä¸­ç­›é€‰å‰100ä½
val topFriends = ForestFriendManager.getSmartFilteredFriends(
    allFriends, topN = 100
)
```

### ä½¿ç”¨åŠ¨æ€å†·å´
```kotlin
// è®°å½•æ‰¾èƒ½é‡å°è¯•
ForestFriendManager.recordFindEnergyAttempt(energy, friendsChecked)

// è·å–åŠ¨æ€å†·å´æ—¶é—´
val cooldown = ForestFriendManager.getCurrentCooldown()
// è¿”å›: 10-20åˆ†é’Ÿï¼Œæ ¹æ®æˆåŠŸç‡è‡ªåŠ¨è°ƒæ•´
```

---

## ğŸ“ˆ config_v2.jsonåˆ†æ

### éœ€è¦ä¼˜åŒ–çš„é…ç½®
```json
// å»ºè®®è°ƒæ•´ï¼ˆé™ä½é£æ§ï¼‰
"queryInterval": "1000-1500",   // ä»500-800å¢åŠ 
"collectInterval": "800-1200",  // ä»500-800å¢åŠ 
"checkInterval": 3600000        // ä»5400000ç¼©çŸ­åˆ°60åˆ†é’Ÿ
```

### é…ç½®è‰¯å¥½çš„é¡¹
```json
"execAtTimeList": ["0000", ...],  // âœ…å·²åŒ…å«0ç‚¹
"taskExecutionRounds": 2,         // âœ…2è½®åˆç†
"errNotify": true,                // âœ…é”™è¯¯é€šçŸ¥
"recordLog": true                 // âœ…è®°å½•æ—¥å¿—
```

---

## ğŸ¯ é¢„æœŸæ•ˆæœ

### æ€§èƒ½æå‡
- å¥½å‹æ£€æŸ¥: 587ä½ â†’ 100ä½ (83%â†“)
- é£æ§è§¦å‘: é™ä½40%
- èƒ½é‡æ•ˆç‡: æå‡25%

### ç¨³å®šæ€§æå‡
- âœ… 1009è‡ªåŠ¨æš‚åœ
- âœ… åŠ¨æ€é€‚åº”ç½‘ç»œ
- âœ… æ™ºèƒ½ç­›é€‰å¥½å‹

---

## ğŸš€ ä¸‹ä¸€æ­¥

### å¾…é›†æˆ
1. å°†RpcErrorHandleré›†æˆåˆ°RequestManager
2. å°†ForestFriendManageré›†æˆåˆ°AntForest
3. æ·»åŠ é…ç½®ç•Œé¢

### å¾…æµ‹è¯•
1. 00:00å”¤é†’åŠŸèƒ½
2. 1009é€€é¿æœºåˆ¶
3. åŠ¨æ€å¹¶å‘æ•ˆæœ
4. æ™ºèƒ½ç­›é€‰å‡†ç¡®æ€§

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**: 2025-10-19 00:32  
**æ–°å¢ä»£ç è¡Œæ•°**: 595è¡Œ  
**ä¿®æ”¹æ–‡ä»¶æ•°**: 4ä¸ª
